<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>√âcouter de la musique - MAUI, c'est clair !</title><meta name=author content="Jean-Emmanuel BAILLAT">
<meta name=author-link content="https://github.com/Kapusch"><meta name=description content="Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"><meta name=keywords content="MediaElement,.NET Community Toolkit,MVVM,Data Binding,ImageButton"><meta itemprop=name content="√âcouter de la musique"><meta itemprop=description content="Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"><meta itemprop=datePublished content="2023-09-18T00:00:10+00:00"><meta itemprop=dateModified content="2023-09-18T00:00:10+00:00"><meta itemprop=wordCount content="1690"><meta itemprop=image content="https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/featured-image-preview-en.png"><meta itemprop=keywords content="MediaElement,.NET Community Toolkit,MVVM,Data Binding,ImageButton,"><meta property="og:title" content="√âcouter de la musique"><meta property="og:description" content="Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"><meta property="og:type" content="article"><meta property="og:url" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/"><meta property="og:image" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/featured-image-preview-en.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-18T00:00:10+00:00"><meta property="article:modified_time" content="2023-09-18T00:00:10+00:00"><meta property="og:see_also" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/11-binding-playhead-control/"><meta property="og:see_also" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/9-volume-tracker/"><meta property="og:see_also" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/8-media-control/"><meta property="og:see_also" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/7-time-tracker/"><meta property="og:see_also" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/6-scaffolding/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/featured-image-preview-en.png"><meta name=twitter:title content="√âcouter de la musique"><meta name=twitter:description content="Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"><meta name=twitter:site content="@kapuschinfo"><meta name=application-name content="MAUI, c'est clair !"><meta name=apple-mobile-web-app-title content="MAUI, c'est clair !"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/><link rel=prev href=https://www.mauicestclair.fr/posts/tutos/my-first-app/9-volume-tracker/><link rel=next href=https://www.mauicestclair.fr/posts/tutos/my-first-app/11-binding-playhead-control/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"√âcouter de la musique","inLanguage":"fr","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.mauicestclair.fr\/posts\/tutos\/my-first-app\/10-play-music\/"},"genre":"posts","keywords":"MediaElement, .NET Community Toolkit, MVVM, Data Binding, ImageButton","wordcount":1690,"url":"https:\/\/www.mauicestclair.fr\/posts\/tutos\/my-first-app\/10-play-music\/","datePublished":"2023-09-18T00:00:10+00:00","dateModified":"2023-09-18T00:00:10+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Jean-Emmanuel BAILLAT"},"description":"Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=wide><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="MAUI, c'est clair !"><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title="MAUI, c'est clair !" data-alt="MAUI, c'est clair !" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>MAUI, c'est clair !</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/posts/><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Articles</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/posts/tutos/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> Cours</a></li><li class=menu-item><a class=menu-link href=/posts/tips/><i class="fa-solid fa-lightbulb fa-fw fa-sm" aria-hidden=true></i> Astuces</a></li></ul></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> √Ä propos</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Rechercher des titres, des contenus..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Chercher><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Effacer><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Changer de Th√®me"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language-switch"><span role=button aria-label="Choisir la langue" title="Choisir la langue"><i class="fa-solid fa-language fa-fw" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><span class="menu-link text-secondary" title=Fran√ßais>Fran√ßais</span></li><li class=menu-item><a href=/en/posts/tutos/my-first-app/10-play-music/ class=menu-link title=English>English</a></li></ul></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="MAUI, c'est clair !"><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title=/main_avatar.jpg data-alt=/main_avatar.jpg class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>MAUI, c'est clair !</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Rechercher des titres, des contenus..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Chercher><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Effacer><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Annuler</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/posts/><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Articles</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/posts/tutos/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> Cours</a></li><li class=menu-item><a class=menu-link href=/posts/tips/><i class="fa-solid fa-lightbulb fa-fw fa-sm" aria-hidden=true></i> Astuces</a></li></ul></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> √Ä propos</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Changer de Th√®me"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span><span class="menu-system-item language-switch">
<span role=button aria-label="Choisir la langue" title="Choisir la langue">Fran√ßais<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option value=/posts/tutos/my-first-app/10-play-music/ selected disabled>Fran√ßais</option><option value=/en/posts/tutos/my-first-app/10-play-music/>English</option></select></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/posts/ title=Publications>Publications</a></li><li class=breadcrumb-item><a href=/posts/tutos/ title=Cours>Cours</a></li><li class=breadcrumb-item><a href=/posts/tutos/my-first-app/ title="Ma premi√®re app">Ma premi√®re app</a></li><li class="breadcrumb-item active" aria-current=page>√âcouter de la musique</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>Contenus&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>√âcouter de la musique</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/Kapusch target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title="Jean-Emmanuel BAILLAT" data-alt="Jean-Emmanuel BAILLAT" class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Jean-Emmanuel BAILLAT</a></span></div><div class=post-meta-line><span title="publi√© le 2023-09-18 00:00:10"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=18/09/2023>18/09/2023</time></span>&nbsp;<span title="Mis √† jour le 2023-09-18 00:00:10"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=18/09/2023>18/09/2023</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>1690 mots</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>8 minutes</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contenus</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#le-mediaelement>Le MediaElement</a></li><li><a href=#faites-du-bruit->Faites du bruit !</a></li><li><a href=#contr√¥ler-la-lecture-du-m√©dia>Contr√¥ler la lecture du m√©dia</a></li></ul></nav></div></div><div class=content id=content><p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Pour assurer le bon d√©roulement de cet article, je t‚Äôinvite √† r√©cup√©rer le projet reprenant toutes les √©tapes appliqu√©es jusqu‚Äôici dans ce cours. Pour cela, r√©f√®re-toi au <a href=../2-setup-the-project/>guide d‚Äôinstallation du projet</a> et repars de l‚Äôexemple situ√© dans le dossier <em>‚Äú4 - All Media Controls‚Äù</em>.</div></div></div>Avant d‚Äôentamer ce nouveau chapitre, je voulais te f√©liciter pour tout ce chemin parcouru !</p><p>Maintenant qu‚Äôon a bien avanc√© sur la partie visuelle, on va pouvoir d√©velopper le c≈ìur de l‚Äôapplication et ainsi la rendre un peu plus fonctionnelle. Et s‚Äôil y a bien une fonctionnalit√© √† impl√©menter en priorit√©, c‚Äôest la lecture de titres musicaux !</p><h1 id=le-mediaelement>Le MediaElement</h1><p>Dans l‚Äôunivers du mobile, la manipulation des m√©dias est compl√®tement diff√©rente d‚Äôun syst√®me √† un autre. Heureusement, Microsoft nous simplifie la vie avec son <a href=https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/ target=_blank rel="external nofollow noopener noreferrer">Community Toolkit<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> qui propose justement de quoi lire des fichiers audio depuis n‚Äôimporte quelle plateforme: le <a href=https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/views/mediaelement target=_blank rel="external nofollow noopener noreferrer">MediaElement<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> !</p><p>D‚Äôapr√®s la <a href="https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/get-started?tabs=CommunityToolkitMauiMediaElement#adding-the-nuget-packages" target=_blank rel="external nofollow noopener noreferrer">documentation<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>, ce composant est fourni dans un paquet NuGet qui lui est d√©di√©. Pour installer cette d√©pendance, ouvre le gestionnaire de paquets NuGet et recherche la librairie nomm√©e <em>CommunityToolkit.Maui.MediaElement.</em></p><p align=center><img max-width=100% max-height=100% src=./images/8A5155B8383781A2F73B09AC400E2190.png></p><figure></figure><p>Une fois trouv√©e, ajoute-la au projet en acceptant toutes les licences associ√©es:</p><p align=center><img max-width=100% max-height=100% src=./images/E99C2364767ABBFA91D00D88D3EEAEEE.png></p><figure></figure><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Un fichier <em>ReadMe.txt</em> s‚Äôouvre automatiquement dans Visual Studio. Il donne des indications suppl√©mentaires que nous allons appliquer pour utiliser le <em>MediaElement</em>.</div></div></div><p>Maintenant que la librairie est ajout√©e au projet, il reste une derni√®re √©tape pour utiliser le composant <em>MediaElement</em>. En effet, il est n√©cessaire de l‚Äôinitialiser au d√©marrage de l‚Äôapplication dans le fichier <code>MauiProgram.cs</code>.</p><p>Ouvre donc ce fichier et modifie la m√©thode <em>CreateMauiApp()</em> de la fa√ßon suivante :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MauiProgram.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>MauiApp</span> <span class=n>CreateMauiApp</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;[NightClub] MauiProgram - CreateMauiApp&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kt>var</span> <span class=n>builder</span> <span class=p>=</span> <span class=n>MauiApp</span><span class=p>.</span><span class=n>CreateBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>.</span><span class=n>UseMauiCommunityToolkit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>.</span><span class=n>UseMauiCommunityToolkitMarkup</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=c1>// Tu dois ajouter la ligne ci-dessous:</span>
</span></span><span class=line><span class=cl>		<span class=p>.</span><span class=n>UseMauiCommunityToolkitMediaElement</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>.</span><span class=n>UseMauiApp</span><span class=p>&lt;</span><span class=n>App</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>builder</span><span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class="details admonition comment open"><div class="details-summary admonition-title"><i class="icon fa-regular fa-comments fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>üêí‚Äé ‚Äé Ok, mais qu‚Äôest-ce qu‚Äôelle fait exactement cette m√©thode <em>UseMauiCommunityToolkitMediaElement()</em> ?</div></div></div><p>Bon r√©flexe ! Quand on manipule des nouveaux bouts de code, c‚Äôest toujours mieux de comprendre ce qu‚Äôils d√©clenchent derri√®re. Et dans le cas pr√©sent, le code est open-source et peut √™tre consult√© <a href=https://github.com/CommunityToolkit/Maui/blob/77213ae1e2ad5730fd29126bb2cf85960ba89bbd/src/CommunityToolkit.Maui.MediaElement/AppBuilderExtensions.shared.cs target=_blank rel="external nofollow noopener noreferrer">ici<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>.</p><p>Sans grande surprise, la m√©thode <em>UseMauiCommunityToolkitMediaElement()</em> n‚Äôa pour but que de mettre √† disposition le fameux <em>MediaElement</em> pour notre application. Dans les grandes lignes, cela consiste √† pr√©ciser quelles classes impl√©mentent son comportement, pour chacune des plateformes cibl√©es.</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Pour plus d‚Äôinformation, consulte la <a href=https://learn.microsoft.com/fr-fr/dotnet/maui/user-interface/handlers/create target=_blank rel="external nofollow noopener noreferrer">documentation sur les contr√¥les personnalis√©s<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>.</div></div></div><p>√áa y‚Äôest, on va pouvoir √©couter de la musique !</p><h1 id=faites-du-bruit->Faites du bruit !</h1><p>Voyons d√©sormais comment d√©finir une instance du <em>MediaElement</em> dans la vue <em>MusicPlayerView</em>.</p><div class="details admonition comment open"><div class="details-summary admonition-title"><i class="icon fa-regular fa-comments fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>üêí‚Äé ‚Äé Mais finalement, est-ce qu‚Äôon ne devrait pas consid√©rer le <em>MediaElement</em> comme un service et l‚Äôajouter au <em>ViewModel</em> ?</div></div></div><p>C‚Äôest une tr√®s bonne remarque ! En effet, dans <a href=../4-mvvm-is-the-key-to-succeed/>le chapitre sur le MVVM</a>, on a pr√©sent√© la <strong>View</strong> comme la couche correspondant √† l‚Äôinterface utilisateur. En toute logique, on pourrait donc penser que la lecture de m√©dias intervient uniquement dans le <strong>ViewModel</strong> !</p><p>Seulement, apr√®s avoir lu la <a href=https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/views/mediaelement target=_blank rel="external nofollow noopener noreferrer">documentation<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>, tu constateras que le <em>MediaElement</em> fournit les contr√¥les visuels de base pour manipuler des m√©dias selon la plateforme cible. Et m√™me si nous ne les utiliserons pas (puisque nous cr√©ons nos propres contr√¥les), le <em>MediaElement</em> est bien un √©l√©ment de l‚Äôinterface utilisateur ! Et c‚Äôest pour respecter le d√©coupage du MVVM que je pr√©f√®re d√©finir une instance du <em>MediaElement</em> dans la vue <em>MusicPlayerView</em>.</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Il est tout √† fait possible d‚Äôaccomplir la m√™me chose en pla√ßant le <em>MediaElement</em> dans le <em>ViewModel</em> au lieu de la <em>View</em>, mais il y a des chances que cela complexifie la maintenance du projet.</div></div></div><p>Ouvre donc le fichier <code>MusicPlayerView.cs</code>, puis d√©finis une nouvelle propri√©t√© de type <em>MediaElement</em> dans la region d√©di√©e aux contr√¥les, ainsi qu‚Äôune m√©thode <em>InitMusicPlayer()</em> pour l‚Äôinitialiser :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=cp>#region</span> <span class=n>Controls</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=cp>#region</span> <span class=n>MusicPlayer</span> <span class=c1>// Et pourquoi pas une nouvelle r√©gion !</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>MediaElement</span> <span class=n>MusicPlayer</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MediaElement</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>void</span> <span class=n>InitMusicPlayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>MusicPlayer</span><span class=p>.</span><span class=n>ShouldAutoPlay</span> <span class=p>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=kt>string</span> <span class=n>trackURL</span> <span class=p>=</span> <span class=s>&#34;https://prod-1.storage.jamendo.com/?trackid=1890762&amp;format=mp31&amp;from=b5bSbOTAT1kXawaT8EV9IA%3D%3D%7CGcDX%2BeejT3P%2F0CfPwtSyYA%3D%3D&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=n>MusicPlayer</span><span class=p>.</span><span class=n>Source</span> <span class=p>=</span> <span class=n>MediaSource</span><span class=p>.</span><span class=n>FromUri</span><span class=p>(</span><span class=n>trackURL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl><span class=cp>#endregion</span>
</span></span></code></pre></td></tr></table></div></div><p>Avec le param√®tre <code>ShouldAutoPlay</code>, on configure notre nouveau contr√¥le pour automatiquement jouer le prochain titre, aussit√¥t qu‚Äôil est d√©fini. En effet, nos boutons sont toujours factices, or on a besoin d‚Äôentendre de la musique pour v√©rifier que le <em>MediaElement</em> fonctionne !</p><div class="details admonition comment open"><div class="details-summary admonition-title"><i class="icon fa-regular fa-comments fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>üêí‚Äé ‚Äé Et la musique en question, c‚Äôest du streaming audio ?</div></div></div><p>Oui c‚Äôest √ßa ! Pour notre application, j‚Äôai r√©cup√©r√© quelques chansons depuis <a href=https://www.jamendo.com/ target=_blank rel="external nofollow noopener noreferrer">Jamendo<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>, un site Web gratuit de musique produite par des artistes ind√©pendants.</p><p>Comme tu as du le remarquer, nous avons donc d√©fini un morceau √† jouer par d√©faut √† travers la variable <code>trackURL</code>. En effet, cette URL est alors d√©clar√©e comme une <code>Source</code> de m√©dia pour le <em>MediaElement</em>, avec l‚Äôaide de la m√©thode <em>MediaSource.FromUri()</em>.</p><p>Retournons maintenant au constructeur de notre page. Dans un premier temps, nous devons initialiser le <code>MediaPlayer</code> avec la m√©thode <em>InitMusicPlayer()</em> que l‚Äôon vient de pr√©senter. Enfin, nous devons √©galement rajouter ce composant en tant qu‚Äô√©l√©ment de la vue pour le rendre disponible. Autrement, il ne serait pas d√©tect√© par la page et ne pourrait pas fonctionner !</p><p>Voici donc √† quoi ressemble d√©sormais le constructeur de la vue <em>MusicPlayerView</em> :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>CommunityToolkit.Maui.Views</span><span class=p>;</span> <span class=c1>// Attention √† bien ajouter ce using !</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.Views</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicPlayerView</span> <span class=p>:</span> <span class=n>ContentPage</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=n>MusicPlayerView</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;[NightClub] MusicPlayerView - Constructor&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>NavigationPage</span><span class=p>.</span><span class=n>SetHasNavigationBar</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=n>BackgroundColor</span> <span class=p>=</span> <span class=n>Colors</span><span class=p>.</span><span class=n>DimGray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>InitMusicPlayer</span><span class=p>();</span> <span class=c1>// On initialise le contr√¥le avec sa m√©thode d√©di√©e</span>
</span></span><span class=line><span class=cl>		<span class=n>InitMuteButton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>Content</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Grid</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>RowDefinitions</span> <span class=p>=</span> <span class=n>Rows</span><span class=p>.</span><span class=n>Define</span><span class=p>(</span>
</span></span><span class=line><span class=cl>			<span class=n>Stars</span><span class=p>(</span><span class=m>60</span><span class=p>),</span>
</span></span><span class=line><span class=cl>			<span class=n>Stars</span><span class=p>(</span><span class=m>40</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>			<span class=n>RowSpacing</span> <span class=p>=</span> <span class=m>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=n>Children</span> <span class=p>=</span>
</span></span><span class=line><span class=cl>			<span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=n>MusicPlayer</span><span class=p>,</span> <span class=c1>// Et on ajoute le contr√¥le au contenu de la page !</span>
</span></span><span class=line><span class=cl>				<span class=n>TopLayout</span><span class=p>.</span><span class=n>Row</span><span class=p>(</span><span class=m>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=n>BottomLayout</span><span class=p>.</span><span class=n>Row</span><span class=p>(</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>};</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Il n‚Äôest pas n√©cessaire de pr√©ciser o√π l‚Äô√©l√©ment sera d√©fini dans la grille. En effet, le <em>MusicPlayer</em> restera de toute mani√®re invisible pour l‚Äôutilisateur !</div></div></div><p>Et si on faisait un essai ? Prends d&rsquo;abord le temps de r√©gler le volume de ton appareil de sorte √† ce que cela ne soit ni trop fort, ni trop faible. Puis, relance le projet pour d√©marrer l&rsquo;application.</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Pense √† quitter l&rsquo;application ou arr√™ter le d√©boggage du projet dans Visual Studio pour arr√™ter la musique !</div></div></div><p>Alors, content¬∑e d‚Äôentendre enfin un peu de musique ?¬†Apr√®s tant d&rsquo;efforts, c&rsquo;est m√©rit√© ! üôÇ</p><p>Mais voyons si on ne peut pas en profiter pour donner vie √† ce bouton de lecture.</p><h1 id=contr√¥ler-la-lecture-du-m√©dia>Contr√¥ler la lecture du m√©dia</h1><p>Maintenant qu&rsquo;on a v√©rifi√© que la lecture de m√©dia fonctionnait, ce serait mieux de pouvoir la contr√¥ler directement avec le bouton ‚ÄúPlay‚Äù ! Suivant le m√™me principe que tout √† l‚Äôheure, initialisons le contr√¥le <code>PlayButton</code> via une nouvelle m√©thode <em>InitMediaControlPanel()</em>, appel√©e depuis le constructeur de la page. Voici les modifications apport√©es √† la vue <em>MusicPlayerView</em> :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicPlayerView</span> <span class=p>:</span> <span class=n>ContentPage</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=n>MusicPlayerView</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=p>...</span>
</span></span><span class=line><span class=cl>		<span class=n>InitMusicPlayer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=n>InitMediaControlPanel</span><span class=p>();</span> <span class=c1>// Une nouvelle m√©thode d&#39;initialisation ...</span>
</span></span><span class=line><span class=cl>		<span class=n>InitMuteButton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=cp>#region</span> <span class=n>Media</span> <span class=n>Control</span> <span class=n>Panel</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=n>ImageButton</span> <span class=n>PlayButton</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ImageButton</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>CornerRadius</span> <span class=p>=</span> <span class=m>50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>HeightRequest</span> <span class=p>=</span> <span class=m>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>WidthRequest</span> <span class=p>=</span> <span class=m>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>BackgroundColor</span> <span class=p>=</span> <span class=n>Colors</span><span class=p>.</span><span class=n>Black</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>Source</span> <span class=p>=</span> <span class=s>&#34;play.png&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>void</span> <span class=n>InitMediaControlPanel</span><span class=p>()</span> <span class=c1>// ... dont voici la d√©finition !</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>PlayButton</span><span class=p>.</span><span class=n>Bind</span><span class=p>(</span>
</span></span><span class=line><span class=cl>			<span class=n>targetProperty</span><span class=p>:</span> <span class=n>ImageButton</span><span class=p>.</span><span class=n>SourceProperty</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=n>source</span><span class=p>:</span> <span class=n>MusicPlayer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=n>path</span><span class=p>:</span> <span class=n>nameof</span><span class=p>(</span><span class=n>MusicPlayer</span><span class=p>.</span><span class=n>CurrentState</span><span class=p>),</span>
</span></span><span class=line><span class=cl>			<span class=n>convert</span><span class=p>:</span> <span class=p>(</span><span class=n>MediaElementState</span> <span class=n>currentState</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=p>=&gt;</span> <span class=n>currentState</span> <span class=p>!=</span> <span class=n>MediaElementState</span><span class=p>.</span><span class=n>Playing</span> <span class=p>?</span> <span class=s>&#34;play.png&#34;</span> <span class=p>:</span> <span class=s>&#34;pause.png&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>PlayButton</span><span class=p>.</span><span class=n>Clicked</span> <span class=p>+=</span> <span class=n>PlayButton_Clicked</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=cp>#endregion</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Dans un premier temps, on souhaite que l‚Äôic√¥ne associ√©e √† notre bouton central change d‚Äôapparence selon si la chanson est en train d‚Äô√™tre jou√©e (image: <em>pause.png</em>) ou pas (image: <em>play.png</em>). Pour cela, on applique la technique du Binding (cf: <a href=../4-mvvm-is-the-key-to-succeed/#le-data-binding>MVVM</a>) sur la propri√©t√© <em>Source</em> du <code>PlayButton</code> qui n‚Äôest autre que la propri√©t√© pour d√©finir l‚Äôic√¥ne du bouton.</p><p>Voici donc la logique mise en place pour en modifier la valeur automatiquement :</p><ul><li><p>On surveille les changements de valeur de la propri√©t√© <em>CurrentState</em> rattach√©e √† l‚Äôobjet <code>MusicPlayer</code>,</p></li><li><p>Et on modifie l‚Äôimage du <code>PlayButton</code> selon si la valeur du <em>CurrentState</em> √©quivaut √† l‚Äô√©tat de lecture ou l‚Äô√©tat de pause.</p></li></ul><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‚Äé<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Attention √† bien remplacer le signe ‚Äú=>‚Äù par ‚Äú=‚Äù √† la d√©claration du <code>PlayButton</code>. En effet, on ne veut cr√©er qu‚Äôune seule instance d‚Äô<code>ImageButton</code> et la modifier dans la m√©thode <em>InitMediaControlPanel()</em>.</div></div></div><p>Ensuite, on d√©finit un comportement sp√©cifique au clic de l‚Äôutilisateur sur le <code>PlayButton</code> avec la m√©thode <em>PlayButton_Clicked()</em>. Voici √† quoi correspond cette m√©thode :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicPlayerView</span> <span class=p>:</span> <span class=n>ContentPage</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=cp>#region</span> <span class=n>Events</span> <span class=c1>// Quand on aime l&#39;organisation, on utilise les r√©gions !</span>
</span></span><span class=line><span class=cl>	<span class=kd>protected</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>OnAppearing</span><span class=p>()...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>protected</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>OnDisappearing</span><span class=p>()...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>void</span> <span class=n>PlayButton_Clicked</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>EventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>MusicPlayer</span><span class=p>.</span><span class=n>CurrentState</span> <span class=p>!=</span> <span class=n>MediaElementState</span><span class=p>.</span><span class=n>Playing</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>MusicPlayer</span><span class=p>.</span><span class=n>Play</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>else</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>MusicPlayer</span><span class=p>.</span><span class=n>Pause</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=cp>#endregion</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Comme tu peux le voir, cet √©v√©nement est plut√¥t simple. √Ä chaque clic, on d√©tecte quel est l‚Äô√©tat actuel du lecteur de musique, et selon, on demande la mise en lecture ou la mise en pause du morceau.</p><hr><p>Voil√†, c‚Äôest tout pour ce chapitre. Recompile le projet et mets en pause la musique !</p><p align=center><img max-width=100% max-height=100% src=./images/96DBF61EF00CCED6F97B6937F1B5B0F5.gif></p><figure><figcaption class=image-caption>Le morceau est jou√© d√®s que la page du lecteur de musique appara√Æt, puis on peut stopper la lecture avec le bouton pause.</figcaption></figure><p>Quel plaisir de pouvoir interagir avec notre app, n‚Äôest-ce pas ? Personnellement, c‚Äôest la partie que je pr√©f√®re dans le d√©veloppement d‚Äôune application !</p><p>√áa se concr√©tise et ce n‚Äôest que le d√©but. <a href=../11-binding-playhead-control/>La prochaine fois</a>, on verra comment impl√©menter la gestion du volume et de la t√™te de lecture.</p><hr><p>Plus d&rsquo;articles dans la m√™me s√©rie:<ol><div><li hugo-nav=/posts/tutos/my-first-app/1-introduction/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/1-introduction/>Introduction</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/2-setup-the-project/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/2-setup-the-project/>Installer le projet</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/3-first-run-of-the-project/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/3-first-run-of-the-project/>Premi√®re ex√©cution du projet</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/4-mvvm-is-the-key-to-succeed/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/4-mvvm-is-the-key-to-succeed/>MVVM, la cl√© de la r√©ussite</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/5-how-to-navigate/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/5-how-to-navigate/>D‚Äôune page √† l‚Äôautre</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/6-scaffolding/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/6-scaffolding/>Les fondations</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/7-time-tracker/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/7-time-tracker/>Le temps d‚Äô√©coute</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/8-media-control/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/8-media-control/>Les contr√¥les de lecture du m√©dia</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/9-volume-tracker/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/9-volume-tracker/>Le niveau sonore</a></li></div><div class=current><li hugo-nav=/posts/tutos/my-first-app/10-play-music/ class=nostyle><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/>√âcouter de la musique</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/11-binding-playhead-control/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/11-binding-playhead-control/>Contr√¥ler la t√™te de lecture</a></li></div></ol></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Mis √† jour le 2023-09-18 00:00:10">Mis √† jour le 18/09/2023&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Partager via Twitter" data-sharer=twitter data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/ data-title="√âcouter de la musique" data-via=kapuschinfo data-hashtags="MediaElement,.NET Community Toolkit,MVVM,Data Binding,ImageButton"><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Facebook" data-sharer=facebook data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/ data-hashtag=MediaElement><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Linkedin" data-sharer=linkedin data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Blogger" data-sharer=blogger data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music/ data-title="√âcouter de la musique" data-description="Brique par brique, notre application prend forme ! Mais ce n‚Äôest que visuel pour le moment‚Ä¶ il est temps d‚Äôajouter du concret derri√®re tous ces contr√¥les factices !"><i class="fa-brands fa-blogger fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/mediaelement/ class=post-tag>MediaElement</a><a href=/tags/.net-community-toolkit/ class=post-tag>.NET Community Toolkit</a><a href=/tags/mvvm/ class=post-tag>MVVM</a><a href=/tags/data-binding/ class=post-tag>Data Binding</a><a href=/tags/imagebutton/ class=post-tag>ImageButton</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Retour</a></span>&nbsp;|&nbsp;<span><a href=/>Accueil</a></span></section></div><div class=post-nav><a href=/posts/tutos/my-first-app/9-volume-tracker/ class=post-nav-item rel=prev title="Le niveau sonore"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Le niveau sonore</a>
<a href=/posts/tutos/my-first-app/11-binding-playhead-control/ class=post-nav-item rel=next title="Contr√¥ler la t√™te de lecture">Contr√¥ler la t√™te de lecture<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=Kapusch/blog-dotnet-maui data-repo-id=R_kgDOH_4TbQ data-category="Blog comments" data-category-id=DIC_kwDOH_4Tbc4CSqsZ data-mapping=Title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=fr crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></div><div class="footer-line powered">Propuls√© par <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.120.4">Hugo</a> | Th√®me - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.18"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/Kapusch target=_blank rel="external nofollow noopener noreferrer">Jean-Emmanuel BAILLAT</a></span><span class="license footer-divider"><u><a rel="license external nofollow noopener noreferrer" href=/privacy-policy target=_blank>Confidentialit√©</a></u> et <u><a rel="license external nofollow noopener noreferrer" href=/terms-of-use target=_blank>CGU</a></u></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Retour en Haut"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label="Afficher les Commentaires"><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/Kapusch/blog-dotnet-maui/tree/main/Blog title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>Le th√®me FixIt fonctionne mieux quand JavaScript est activ√©.</div></noscript></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/lunr/lunr.min.js defer></script><script src=/lib/lunr/lunr.stemmer.support.min.js defer></script><script src=/lib/lunr/lunr.fr.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script>window.config={code:{copyTitle:"Copier dans le presse-papiers",maxShownLines:50},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark_dimmed",lightTheme:"light"}},cookieconsent:{content:{dismiss:"J'ai compris !",link:"En apprendre plus",message:"Ce site Web utilise des Cookies pour am√©liorer votre exp√©rience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"fr",maxResultLength:10,noResultsFound:"Aucun r√©sultat trouv√©",snippetLength:110,type:"lunr"}}</script><script src=/js/theme.min.js defer></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0BB9XCL25S",{anonymize_ip:!0})</script><script src="https://www.googletagmanager.com/gtag/js?id=G-0BB9XCL25S" async></script></body></html>