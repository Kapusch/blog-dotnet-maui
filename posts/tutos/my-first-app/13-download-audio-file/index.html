<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Télécharger un fichier audio en .NET MAUI - MAUI, c'est clair !</title><meta name=author content="Jean-Emmanuel BAILLAT">
<meta name=author-link content="https://github.com/Kapusch"><meta name=description content="Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"><meta name=keywords content='Data Binding,MediaElement,MVVM,.NET Community Toolkit'><meta itemprop=name content="Télécharger un fichier audio en .NET MAUI"><meta itemprop=description content="Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"><meta itemprop=datePublished content="2023-12-19T00:00:13+00:00"><meta itemprop=dateModified content="2023-12-19T00:00:13+00:00"><meta itemprop=wordCount content="2050"><meta itemprop=image content="https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/featured-image-preview-en.png"><meta itemprop=keywords content="Data Binding,MediaElement,MVVM,.NET Community Toolkit,"><meta property="og:title" content="Télécharger un fichier audio en .NET MAUI"><meta property="og:description" content="Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"><meta property="og:type" content="article"><meta property="og:url" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/"><meta property="og:image" content="https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/featured-image-preview-en.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-19T00:00:13+00:00"><meta property="article:modified_time" content="2023-12-19T00:00:13+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/featured-image-preview-en.png"><meta name=twitter:title content="Télécharger un fichier audio en .NET MAUI"><meta name=twitter:description content="Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"><meta name=twitter:site content="@kapuschinfo"><meta name=application-name content="MAUI, c'est clair !"><meta name=apple-mobile-web-app-title content="MAUI, c'est clair !"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/><link rel=prev href=https://www.mauicestclair.fr/posts/tutos/my-first-app/12-control-volume-with-mediaelement/><link rel=next href=https://www.mauicestclair.fr/posts/tutos/my-first-app/14-skip-next-or-previous-with-mediaelement/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Télécharger un fichier audio en .NET MAUI","inLanguage":"fr","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.mauicestclair.fr\/posts\/tutos\/my-first-app\/13-download-audio-file\/"},"genre":"posts","keywords":"Data Binding, MediaElement, MVVM, .NET Community Toolkit","wordcount":2050,"url":"https:\/\/www.mauicestclair.fr\/posts\/tutos\/my-first-app\/13-download-audio-file\/","datePublished":"2023-12-19T00:00:13+00:00","dateModified":"2023-12-19T00:00:13+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Jean-Emmanuel BAILLAT"},"description":"Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=wide><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title="MAUI, c'est clair !"><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title="MAUI, c'est clair !" data-alt="MAUI, c'est clair !" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>MAUI, c'est clair !</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/posts/><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Articles</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/posts/tutos/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> Cours</a></li><li class=menu-item><a class=menu-link href=/posts/tips/><i class="fa-solid fa-lightbulb fa-fw fa-sm" aria-hidden=true></i> Astuces</a></li></ul></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> À propos</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Rechercher des titres, des contenus..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Chercher><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Effacer><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Changer de Thème"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language-switch"><span role=button aria-label="Choisir la langue" title="Choisir la langue"><i class="fa-solid fa-language fa-fw" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><span class="menu-link text-secondary" title=Français>Français</span></li><li class=menu-item><a href=/en/posts/tutos/my-first-app/13-download-audio-file/ class=menu-link title=English>English</a></li></ul></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="MAUI, c'est clair !"><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title=/main_avatar.jpg data-alt=/main_avatar.jpg class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>MAUI, c'est clair !</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Rechercher des titres, des contenus..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Chercher><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Effacer><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Annuler</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/posts/><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Articles</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/posts/tutos/><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden=true></i> Cours</a></li><li class=menu-item><a class=menu-link href=/posts/tips/><i class="fa-solid fa-lightbulb fa-fw fa-sm" aria-hidden=true></i> Astuces</a></li></ul></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> À propos</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Changer de Thème"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span><span class="menu-system-item language-switch">
<span role=button aria-label="Choisir la langue" title="Choisir la langue">Français<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option value=/posts/tutos/my-first-app/13-download-audio-file/ selected disabled>Français</option><option value=/en/posts/tutos/my-first-app/13-download-audio-file/>English</option></select></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/posts/ title=Publications>Publications</a></li><li class=breadcrumb-item><a href=/posts/tutos/ title=Cours>Cours</a></li><li class=breadcrumb-item><a href=/posts/tutos/my-first-app/ title="Ma première app">Ma première app</a></li><li class="breadcrumb-item active" aria-current=page>Télécharger un fichier audio en .NET MAUI</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>Contenus&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Télécharger un fichier audio en .NET MAUI</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/Kapusch target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src=/main_avatar.jpg srcset="/main_avatar.jpg, /main_avatar.jpg 1.5x, /main_avatar.jpg 2x" sizes=auto data-title="Jean-Emmanuel BAILLAT" data-alt="Jean-Emmanuel BAILLAT" class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Jean-Emmanuel BAILLAT</a></span></div><div class=post-meta-line><span title="publié le 2023-12-19 00:00:13"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=19/12/2023>19/12/2023</time></span>&nbsp;<span title="Mis à jour le 2023-12-19 00:00:13"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=19/12/2023>19/12/2023</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>2050 mots</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>10 minutes</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contenus</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#création-dun-nouveau-viewmodel>Création d’un nouveau ViewModel</a></li><li><a href=#une-classe-pour-les-pistes-musicales>Une classe pour les pistes musicales</a></li><li><a href=#télécharger-un-morceau>Télécharger un morceau</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Afin d’assurer le bon déroulement de cet article, je t’invite à repartir depuis <a href=../10-play-music-with-mediaelement/>ce chapitre</a> où l’on a configuré le <em>MediaElement</em>.</div></div></div>Et nous voilà reparti pour un nouveau chapitre !</p><p>C’est déjà l’épisode n°13 de cette série, alors j’espère que c’est toujours relativement simple à suivre ! Mais il se peut que tu aies des questions ou des remarques. Si c’est le cas, pose-les moi en commentaires en bas de l’article ou écris-moi directement par e-mail (<a href=mailto:jeanemmanuel.baillat@gmail.com>jeanemmanuel.baillat@gmail.com</a>) !</p><p>Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄</p><h2 id=création-dun-nouveau-viewmodel>Création d’un nouveau ViewModel</h2><p>Avant tout, nous devons mettre en place un nouveau <strong>ViewModel</strong> pour la vue <em>MusicPlayerView</em>. Pour cela, ajoute une nouvelle classe nommée <em>MusicPlayerViewModel</em> dans le dossier <em>ViewModels</em>, et définis-la avec le code suivant :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerViewModel.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>CommunityToolkit.Mvvm.ComponentModel</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>CommunityToolkit.Mvvm.Input</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>MusicPlayerViewModel</span> <span class=p>:</span> <span class=n>ObservableObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cp>#region</span> <span class=n>Properties</span>
</span></span><span class=line><span class=cl>    <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MusicPlayerViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cp>#region</span> <span class=n>Commands</span>
</span></span><span class=line><span class=cl>    <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Si déchiffrer ce bout de code est difficile pour toi, alors ne te décourage pas et prends le temps de relire le <a href=../4-mvvm-for-successful-apps/>chapitre sur le MVVM</a>.</div></div></div>Évidemment, ce <strong>ViewModel</strong> ne fait rien pour le moment, mais il est prêt à être associé à sa <strong>View</strong>. Ouvre donc le fichier <code>MusicPlayerView.cs</code> et modifie-le comme suit :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=c1>// Ce using est obligatoire pour retrouver la définition du MusicPlayerViewModel</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>NightClub.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.Views</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicPlayerView</span> <span class=p>:</span> <span class=n>ContentPage</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MusicPlayerView</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;[NightClub] MusicPlayerView - Constructor&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// C&#39;est ici que l&#39;association s&#39;opère !</span>
</span></span><span class=line><span class=cl>        <span class=n>BindingContext</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MusicPlayerViewModel</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>NavigationPage</span><span class=p>.</span><span class=n>SetHasNavigationBar</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>BackgroundColor</span> <span class=p>=</span> <span class=n>Colors</span><span class=p>.</span><span class=n>DimGray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Comme pour le <em>HomeViewModel</em> que l’on avait associé avec la <em>HomeView</em>, on a modifié ici le <code>BindingContext</code> de la <em>MusicPlayerView</em> pour lui associer le nouveau <em>MusicPlayerViewModel</em>.</p><p>Bon, c’était rapide ! Voyons maintenant comment structurer les données de l’application en définissant le <strong>Model</strong> des pistes musicales.</p><h2 id=une-classe-pour-les-pistes-musicales>Une classe pour les pistes musicales</h2><p>Chaque piste musicale lue dans l’application se définit par un panel d’informations que l’on va regrouper dans une classe nommée <code>MusicTrack</code>. Et comme tu l’auras compris, ce nouvel objet fait parti du <strong>Model</strong> de notre application.</p><p>Commence donc par créer un nouveau dossier intitulé <em>Models</em>, puis ajoutes-y une nouvelle classe définie par le code suivant :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicTrack.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicTrack</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>AudioURL</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>AudioDownloadURL</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Title</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Author</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Pour les besoins de ce cours, 4 propriétés de type <em>string</em> sont nécessaires pour contenir les informations suivantes :</p><ul><li><p>Le lien d’écoute du morceau (<code>AudioURL</code>),</p></li><li><p>Le lien de téléchargement du morceau (<code>AudioDownloadURL</code>),</p></li><li><p>Le nom du morceau (<code>Title</code>),</p></li><li><p>Et le nom de l’auteur du morceau (<code>Author</code>).</p></li></ul><p>Comme il est désormais possible de manipuler des pistes musicales, on va ajouter une propriété de type <code>MusicTrack</code> au <em>MusicPlayerViewModel</em> pour définir la chanson en cours de lecture :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerViewModel.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>NightClub.Models</span><span class=p>;</span> <span class=c1>// Obligatoire pour utiliser la classe MusicTrack !</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>MusicPlayerViewModel</span> <span class=p>:</span> <span class=n>ObservableObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cp>#region</span> <span class=n>Properties</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>    [ObservableProperty]</span>
</span></span><span class=line><span class=cl>    <span class=n>MusicTrack</span> <span class=n>currentTrack</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Une propriété qui s’adapte parfaitement au découpage <strong>Model-View-ViewModel</strong> (MVVM) puisqu’on l’a déclarée comme étant une <code>[ObservableProperty]</code>, une annotation fournie par la librairie <a href=https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/mvvm/ target=_blank rel="external nofollow noopener noreferrer">MVVM Toolkit<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>.</p><p>Cette annotation va alors <a href=https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/mvvm/generators/observableproperty#how-it-works target=_blank rel="external nofollow noopener noreferrer">générer tout le code<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> nécessaire pour déclencher des évènements (généralement vers la <strong>View</strong>) en cas de changement de valeur. En effet, on souhaite calquer les informations affichées dans la <strong>View</strong> sur le <strong>ViewModel</strong> qui lui est associé.</p><p><div class="details admonition comment open"><div class="details-summary admonition-title"><i class="icon fa-regular fa-comments fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>🐒‎ ‎ Compris ! Mais comment va-t’on faire pour définir cette chanson ?</div></div></div>Pour l’instant c’est facile car notre application ne supporte la lecture que d’une seule chanson. On va donc tout simplement l’initialiser depuis le constructeur du <em>MusicPlayerViewModel</em>, comme ceci :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerViewModel.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=n>MusicPlayerViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>CurrentTrack</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MusicTrack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>AudioURL</span> <span class=p>=</span> <span class=s>&#34;https://prod-1.storage.jamendo.com/?trackid=1890762&amp;format=mp31&amp;from=b5bSbOTAT1kXawaT8EV9IA%3D%3D%7CGcDX%2BeejT3P%2F0CfPwtSyYA%3D%3D&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>AudioDownloadURL</span> <span class=p>=</span> <span class=s>&#34;https://prod-1.storage.jamendo.com/download/track/1890762/mp32/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Author</span> <span class=p>=</span> <span class=s>&#34;Alfonso Lugo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Title</span> <span class=p>=</span> <span class=s>&#34;Baila&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Toutes ces informations sont fournies par <a href=https://www.jamendo.com/ target=_blank rel="external nofollow noopener noreferrer">Jamendo<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>, un site de musique gratuite et indépendante.</div></div></div>Mais puisqu’on a défini la piste musicale dans le <em>MusicPlayerViewModel</em>, il nous faut maintenant retravailler la <em>MusicPlayerView</em> pour reconfigurer le <code>MusicPlayer</code>.</p><p>Pour cela, il va falloir modifier la méthode <code>InitMusicPlayer()</code> dans le <em>MusicPlayerView</em>, et appliquer le <strong>Data Binding</strong> à la propriété <code>Source</code> du <em>MediaElement</em> :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>NightClub.Models</span><span class=p>;</span> <span class=c1>// Obligatoire pour utiliser la classe MusicTrack !</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.Views</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MusicPlayerView</span> <span class=p>:</span> <span class=n>ContentPage</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=cp>#region</span> <span class=n>MusicPlayer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MediaElement</span> <span class=n>MusicPlayer</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MediaElement</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Et voici la nouvelle définition de la méthode...</span>
</span></span><span class=line><span class=cl>    <span class=k>void</span> <span class=n>InitMusicPlayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>MusicPlayer</span><span class=p>.</span><span class=n>ShouldAutoPlay</span> <span class=p>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// ... avec ici le binding sur le MusicPlayer.</span>
</span></span><span class=line><span class=cl>        <span class=n>MusicPlayer</span><span class=p>.</span><span class=n>Bind</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>MediaElement</span><span class=p>.</span><span class=n>SourceProperty</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>nameof</span><span class=p>(</span><span class=n>MusicPlayerViewModel</span><span class=p>.</span><span class=n>CurrentTrack</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>convert</span><span class=p>:</span> <span class=p>(</span><span class=n>MusicTrack</span> <span class=n>musicTrack</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>MediaSource</span><span class=p>.</span><span class=n>FromUri</span><span class=p>(</span><span class=n>musicTrack</span><span class=p>.</span><span class=n>AudioURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Souviens-toi, la propriété <code>Source</code> du <em>MediaElement</em> permet de définir la source du média qu’il doit jouer. Et désormais, la propriété <code>MusicPlayer.Source</code> est rattachée dynamiquement à la propriété <code>CurrentTrack</code> définie dans le <em>MusicPlayerViewModel</em>.</p><p>Bien-sûr, on n’oublie pas dans le <em>convert</em> de transformer le lien streaming audio (<code>musicTrack.AudioURL</code>) avec la méthode <em>MediaSource.FromUri()</em>, pour se conformer au type de la propriété <code>Source</code> du <em>MediaElement</em>.</p><p>Et voilà ! Relance donc le projet et vérifie que tout fonctionne comme avant. Je ne voudrais pas te perdre en route ! 😛</p><p>Tout est bien en place ? Alors passons vite à la partie la plus intéressante de ce chapitre : le téléchargement !</p><h2 id=télécharger-un-morceau>Télécharger un morceau</h2><p>Continuons maintenant notre petit bout de chemin en implémentant le bouton de téléchargement.</p><p>Pour cela, on va déjà associer une action déclenchée au clic sur le <code>DownloadButton</code>…</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerView.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=cp>#region</span> <span class=n>Media</span> <span class=n>Control</span> <span class=n>Panel</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=c1>// N&#39;oublie pas de transformer le signe &#34;=&gt;&#34; en &#34;=&#34; !</span>
</span></span><span class=line><span class=cl>    <span class=n>ImageButton</span> <span class=n>DownloadButton</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ImageButton</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>CornerRadius</span> <span class=p>=</span> <span class=m>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>HeightRequest</span> <span class=p>=</span> <span class=m>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>WidthRequest</span> <span class=p>=</span> <span class=m>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Source</span> <span class=p>=</span> <span class=s>&#34;download.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>BackgroundColor</span> <span class=p>=</span> <span class=n>Colors</span><span class=p>.</span><span class=n>Black</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=p>.</span><span class=n>BindCommand</span><span class=p>(</span><span class=s>&#34;DownloadCurrentTrackCommand&#34;</span><span class=p>);</span> <span class=c1>// Et voici la commande associée</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endregion</span>
</span></span></code></pre></td></tr></table></div></div><p>… et dont le comportement sera défini dans <em>MusicPlayerViewModel</em> :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerViewModel.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>CommunityToolkit.Maui.Alerts</span><span class=p>;</span> <span class=c1>// Ce using est nouveau...</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>CommunityToolkit.Maui.Storage</span><span class=p>;</span> <span class=c1>// ... ainsi que celui-ci !</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>NightClub.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>MusicPlayerViewModel</span> <span class=p>:</span> <span class=n>ObservableObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=cp>#region</span> <span class=n>Commands</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>    [RelayCommand]</span>
</span></span><span class=line><span class=cl>    <span class=kd>async</span> <span class=n>Task</span> <span class=n>DownloadCurrentTrack</span><span class=p>(</span><span class=n>CancellationToken</span> <span class=n>cancellationToken</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>Toast</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>Make</span><span class=p>(</span><span class=s>$&#34;[TEST] You have successfully downloaded \&#34;</span><span class=p>{</span><span class=n>CurrentTrack</span><span class=p>.</span><span class=n>Title</span><span class=p>}</span> <span class=p>-</span> <span class=p>{</span><span class=n>CurrentTrack</span><span class=p>.</span><span class=n>Author</span><span class=p>}</span><span class=err>\</span><span class=s>&#34;!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>Show</span><span class=p>(</span><span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cp>#endregion</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Tu te rappelles de l’annotation <code>[RelayCommand]</code> ? On y avait déjà eu recours dans le <a href=../4-mvvm-for-successful-apps/>chapitre sur le MVVM</a>. C’est elle qui permet à notre méthode <em>DownloadCurrentTrack()</em> d’être appelée depuis la <strong>View</strong> !</p><p>Et je t’arrête tout de suite, la méthode <em>Toast()</em> n’a rien à voir avec ton petit-déjeuner ce matin 😄</p><p>Cette <a href="https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/alerts/toast?tabs=ios" target=_blank rel="external nofollow noopener noreferrer">méthode fournie par la librairie .NET MAUI Community Toolkit<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> permet d’afficher temporairement un message à l’écran, à la manière d’une notification directement intégrée dans l’application.</p><p>À ce stade, on peut déjà tester que notre bouton fonctionne bien :</p><p align=center><img max-width=100% max-height=100% src=./images/ADC39E6252DD647F9265309AA68DAF22.gif></p><figure><figcaption class=image-caption>Finalement, ce message est bien utile !</figcaption></figure><p><div class="details admonition comment open"><div class="details-summary admonition-title"><i class="icon fa-regular fa-comments fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>🐒‎ ‎ Oui mais tu essaies de m’arnaquer là, ça ne télécharge rien du tout ! 😄</div></div></div>Je vais te partager le code final juste après&mldr; patience ! 🤓</p><p>Juste avant, j’aurais aimé attirer ton attention sur le paramètre requis par notre nouvelle commande, le <code>cancellationToken</code>. Il s’agit d’un objet de type <a href=https://learn.microsoft.com/fr-fr/dotnet/api/system.threading.cancellationtoken target=_blank rel="external nofollow noopener noreferrer">CancellationToken<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> qui permet de garder un lien avec le code initiateur de l’appel à la méthode <em>DownloadCurrentTrack()</em> en cas de demande d’annulation de son exécution.</p><p>C’est très utile pour les opérations un peu longues, par exemple si notre utilisateur décidait d’annuler le téléchargement par manque de réseau. On ne va pas implémenter cette fonctionnalité aujourd’hui, mais ça serait une très bonne amélioration !</p><p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Aller plus loin avec la <a href=https://learn.microsoft.com/fr-fr/dotnet/standard/threading/cancellation-in-managed-threads target=_blank rel="external nofollow noopener noreferrer">gestion des demandes d’annulation des opérations<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>.</div></div></div>Passons maintenant au téléchargement en lui-même avec l’implémentation complète de la méthode :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>MusicPlayerViewModel.cs</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=cp>#region</span> <span class=n>Commands</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>[RelayCommand]</span>
</span></span><span class=line><span class=cl><span class=kd>async</span> <span class=n>Task</span> <span class=n>DownloadCurrentTrack</span><span class=p>(</span><span class=n>CancellationToken</span> <span class=n>cancellationToken</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// On lève une exception quand l&#39;annulation de l&#39;opération est demandée</span>
</span></span><span class=line><span class=cl>    <span class=n>cancellationToken</span><span class=p>.</span><span class=n>ThrowIfCancellationRequested</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// On a besoin d&#39;un client HTTP pour gérer nos requêtes sur le réseau</span>
</span></span><span class=line><span class=cl>        <span class=n>HttpClient</span> <span class=n>client</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HttpClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>client</span><span class=p>.</span><span class=n>MaxResponseContentBufferSize</span> <span class=p>=</span> <span class=m>100000000</span><span class=p>;</span> <span class=c1>// On peut télécharger jusqu&#39;à ~100Mo de données par fichier !</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// On envoie une requête HTTP vers le lien de téléchargement du morceau</span>
</span></span><span class=line><span class=cl>        <span class=k>using</span> <span class=nn>var</span> <span class=n>httpResponse</span> <span class=p>=</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>client</span><span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Uri</span><span class=p>(</span><span class=n>CurrentTrack</span><span class=p>.</span><span class=n>AudioDownloadURL</span><span class=p>),</span> <span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>httpResponse</span><span class=p>.</span><span class=n>EnsureSuccessStatusCode</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>downloadedImage</span> <span class=p>=</span> <span class=k>await</span> <span class=n>httpResponse</span><span class=p>.</span><span class=n>Content</span><span class=p>.</span><span class=n>ReadAsStreamAsync</span><span class=p>(</span><span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>try</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=s>$&#34;{CurrentTrack.Title} - {CurrentTrack.Author}.mp3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// Puis on transfère les données récupérées dans un fichier</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Note : on a besoin de mettre à jour CommunityToolkit.Maui au moins vers version 5.1.0</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>fileSaveResult</span> <span class=p>=</span> <span class=k>await</span> <span class=n>FileSaver</span><span class=p>.</span><span class=n>SaveAsync</span><span class=p>(</span><span class=n>fileName</span><span class=p>,</span> <span class=n>downloadedImage</span><span class=p>,</span> <span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>fileSaveResult</span><span class=p>.</span><span class=n>EnsureSuccess</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>Toast</span><span class=p>.</span><span class=n>Make</span><span class=p>(</span><span class=s>$&#34;File saved at: {fileSaveResult.FilePath}&#34;</span><span class=p>).</span><span class=n>Show</span><span class=p>(</span><span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>Toast</span><span class=p>.</span><span class=n>Make</span><span class=p>(</span><span class=s>$&#34;Cannot save file because: {ex.Message}&#34;</span><span class=p>).</span><span class=n>Show</span><span class=p>(</span><span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>Toast</span><span class=p>.</span><span class=n>Make</span><span class=p>(</span><span class=s>$&#34;Cannot download file because: {ex.Message}&#34;</span><span class=p>).</span><span class=n>Show</span><span class=p>(</span><span class=n>cancellationToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endregion</span>
</span></span></code></pre></td></tr></table></div></div><p>C’est un gros bout de code, mais rien d’insurmontable !</p><p>Décortiquons cela ensemble pas à pas :</p><ol><li><p>On définit d’abord un client HTTP pour nous permettre d’effectuer une requête vers le lien de téléchargement du morceau en cours de lecture (<code>CurrentTrack.AudioDownloadURL</code>),</p></li><li><p>Nous espérons alors en retour une réponse positive du serveur pour nous fournir les données correspondantes,</p></li><li><p>Et puis si tout va bien, on ouvre un canal de lecture pour transférer ces données dans un fichier et demander sa sauvegarde sur l’appareil.</p></li></ol><p>Comme tu vois, il n’y a vraiment aucune logique complexe ici. C’est seulement un peu technique ! Alors comme à chaque fois, prends le temps pour approfondir le sujet si besoin.</p><p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden=true></i>‎<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Aller plus loin avec <a href=https://learn.microsoft.com/fr-fr/dotnet/fundamentals/networking/http/httpclient target=_blank rel="external nofollow noopener noreferrer">la gestion des requêtes HTTP<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>.</div></div></div>Comme tu l’auras remarqué, la sauvegarde du fichier audio est rendue possible grâce au <a href="https://learn.microsoft.com/fr-fr/dotnet/communitytoolkit/maui/essentials/file-saver?tabs=android" target=_blank rel="external nofollow noopener noreferrer">FileSaver<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>. Cet utilitaire est fourni à partir de la <a href=https://www.nuget.org/packages/CommunityToolkit.Maui/5.1.0 target=_blank rel="external nofollow noopener noreferrer">version 5.1.0 de la librairie CommunityToolkit.Maui<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> et nécessite quelques configurations supplémentaires pour cibler la plateforme Android.</p><p>Pour cela, rends-toi dans le dossier <em>Platforms</em>, puis <em>Android</em>, et ouvre le fichier <em>AndroidManifest.xml</em> pour y rajouter les lignes suivantes :</p><p align=center style=margin-bottom:-10px><strong>Nom du fichier :</strong><code>AndroidManifest.xml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;uses-permission</span> <span class=na>android:name=</span><span class=s>&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span> <span class=na>android:maxSdkVersion=</span><span class=s>&#34;32&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;uses-permission</span> <span class=na>android:name=</span><span class=s>&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span> <span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Enfin, on a codé quelques messages pour aider l’utilisateur à comprendre ce qu’il se passe en arrière-plan. En effet, on ne voudrait pas qu’une erreur survienne pendant le téléchargement et que l’utilisateur attende indéfiniment ! Et comme il ne s’agit que de messages informels, sans aucune action requise, j’ai préféré utiliser le fameux <em>Toast</em> pour afficher des notifications éphémères.</p><p>Et voilà, c’est terminé. Fais vite un essai !</p><p align=center><img max-width=100% max-height=100% src=./images/721B5FB3853965E63793DB681030F88A.gif></p><figure><figcaption class=image-caption>Cette fois-ci, le téléchargement est bien réel !</figcaption></figure><p>Je te félicite pour tout ce travail ! Encore un dernier effort et la manipulation des médias n’aura plus aucun secret pour toi. Rendez-vous au <a href=../14-skip-next-or-previous-with-mediaelement/>prochain chapitre</a> pour gérer la playlist musicale !</p><hr><p>Plus d&rsquo;articles dans la même série:<ol><div><li hugo-nav=/posts/tutos/my-first-app/1-introduction/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/1-introduction/>Ma toute première app en .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/2-setup-the-project/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/2-setup-the-project/>Installation du projet .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/3-first-run-of-the-project/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/3-first-run-of-the-project/>Première exécution de l’app .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/4-mvvm-for-successful-apps/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/4-mvvm-for-successful-apps/>Le MVVM, pour une application réussie</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/5-navigate-to-a-new-page/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/5-navigate-to-a-new-page/>Naviguer vers une nouvelle page en .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/6-arrange-elements-on-a-page/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/6-arrange-elements-on-a-page/>Agencer les éléments d'une page .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/7-music-player-display-time-tracker/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/7-music-player-display-time-tracker/>Affichage du lecteur MP3 - Durée d'écoute</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/8-music-player-display-media-playback/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/8-music-player-display-media-playback/>Affichage du lecteur MP3 - Contrôles de lecture</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/9-music-player-display-volume/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/9-music-player-display-volume/>Affichage du lecteur MP3 - Volume</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/10-play-music-with-mediaelement/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/10-play-music-with-mediaelement/>Écouter de la musique en .NET MAUI avec MediaElement</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/11-control-playback-position-with-mediaelement/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/11-control-playback-position-with-mediaelement/>Contrôler la tête de lecture avec MediaElement</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/12-control-volume-with-mediaelement/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/12-control-volume-with-mediaelement/>Contrôler le volume avec MediaElement</a></li></div><div class=current><li hugo-nav=/posts/tutos/my-first-app/13-download-audio-file/ class=nostyle><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/>Télécharger un fichier audio en .NET MAUI</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/14-skip-next-or-previous-with-mediaelement/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/14-skip-next-or-previous-with-mediaelement/>Écouter une playlist avec MediaElement</a></li></div><div><li hugo-nav=/posts/tutos/my-first-app/15-add-animations-to-an-app/><a href=https://www.mauicestclair.fr/posts/tutos/my-first-app/15-add-animations-to-an-app/>Créer des animations avec .NET MAUI pour une ambiance disco</a></li></div></ol></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Mis à jour le 2023-12-19 00:00:13">Mis à jour le 19/12/2023&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Partager via Twitter" data-sharer=twitter data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/ data-title="Télécharger un fichier audio en .NET MAUI" data-via=kapuschinfo data-hashtags="Data Binding,MediaElement,MVVM,.NET Community Toolkit"><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Facebook" data-sharer=facebook data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/ data-hashtag="Data Binding"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Linkedin" data-sharer=linkedin data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Partager via Blogger" data-sharer=blogger data-url=https://www.mauicestclair.fr/posts/tutos/my-first-app/13-download-audio-file/ data-title="Télécharger un fichier audio en .NET MAUI" data-description="Aujourd’hui, nous allons voir comment permettre à l’utilisateur de télécharger la musique qui est en cours de lecture. Depuis le temps qu’on écoute la même chanson en boucle, je suis sûr que tu rêvais de pouvoir la télécharger depuis l’application ! 😄"><i class="fa-brands fa-blogger fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/data-binding/ class=post-tag>Data Binding</a><a href=/tags/mediaelement/ class=post-tag>MediaElement</a><a href=/tags/mvvm/ class=post-tag>MVVM</a><a href=/tags/.net-community-toolkit/ class=post-tag>.NET Community Toolkit</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Retour</a></span>&nbsp;|&nbsp;<span><a href=/>Accueil</a></span></section></div><div class=post-nav><a href=/posts/tutos/my-first-app/12-control-volume-with-mediaelement/ class=post-nav-item rel=prev title="Contrôler le volume avec MediaElement"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Contrôler le volume avec MediaElement</a>
<a href=/posts/tutos/my-first-app/14-skip-next-or-previous-with-mediaelement/ class=post-nav-item rel=next title="Écouter une playlist avec MediaElement">Écouter une playlist avec MediaElement<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=Kapusch/blog-dotnet-maui data-repo-id=R_kgDOH_4TbQ data-category="Blog comments" data-category-id=DIC_kwDOH_4Tbc4CSqsZ data-mapping=Title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=fr crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></div><div class="footer-line powered">Propulsé par <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.123.0">Hugo</a> | Thème - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.18"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2024</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/Kapusch target=_blank rel="external nofollow noopener noreferrer">Jean-Emmanuel BAILLAT</a></span><span class="license footer-divider"><u><a rel="license external nofollow noopener noreferrer" href=/privacy-policy target=_blank>Confidentialité</a></u> et <u><a rel="license external nofollow noopener noreferrer" href=/terms-of-use target=_blank>CGU</a></u></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Retour en Haut"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label="Afficher les Commentaires"><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/Kapusch/blog-dotnet-maui/tree/main/Blog title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>Le thème FixIt fonctionne mieux quand JavaScript est activé.</div></noscript></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/lunr/lunr.min.js defer></script><script src=/lib/lunr/lunr.stemmer.support.min.js defer></script><script src=/lib/lunr/lunr.fr.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script>window.config={code:{copyTitle:"Copier dans le presse-papiers",maxShownLines:50},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark_dimmed",lightTheme:"light"}},cookieconsent:{content:{dismiss:"J'ai compris !",link:"En apprendre plus",message:"Ce site Web utilise des Cookies pour améliorer votre expérience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"fr",maxResultLength:10,noResultsFound:"Aucun résultat trouvé",snippetLength:110,type:"lunr"}}</script><script src=/js/theme.min.js defer></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0BB9XCL25S",{anonymize_ip:!0})</script><script src="https://www.googletagmanager.com/gtag/js?id=G-0BB9XCL25S" async></script></body></html>